fix: edge cases (duplicates, tiny arrays)
